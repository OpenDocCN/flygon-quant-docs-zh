- en: Data Resampling
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ•°æ®é‡æ–°é‡‡æ ·
- en: åŸæ–‡ï¼š[https://www.backtrader.com/docu/data-resampling/data-resampling/](https://www.backtrader.com/docu/data-resampling/data-resampling/)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://www.backtrader.com/docu/data-resampling/data-resampling/](https://www.backtrader.com/docu/data-resampling/data-resampling/)
- en: When data is only available in a single timeframe and the analysis has to be
    done for a different timeframe, itâ€™s time to do some resampling.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æ•°æ®ä»…åœ¨å•ä¸ªæ—¶é—´æ¡†æ¶ä¸­å¯ç”¨å¹¶ä¸”å¿…é¡»ä¸ºä¸åŒæ—¶é—´æ¡†æ¶è¿›è¡Œåˆ†ææ—¶ï¼Œæ˜¯è¿›è¡Œä¸€äº›é‡æ–°é‡‡æ ·çš„æ—¶å€™äº†ã€‚
- en: 'â€œResamplingâ€ should actually be called â€œUpsamplingâ€ given that one goes from
    a source timeframe to a larger time frame (for example: days to weeks)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: â€œé‡æ–°å–æ ·â€å®é™…ä¸Šåº”è¯¥ç§°ä¸ºâ€œä¸Šå–æ ·â€ï¼Œå› ä¸ºä»ä¸€ä¸ªæºæ—¶é—´æ¡†æ¶åˆ°ä¸€ä¸ªæ›´å¤§çš„æ—¶é—´æ¡†æ¶ï¼ˆä¾‹å¦‚ï¼šä»å¤©åˆ°å‘¨ï¼‰
- en: '`backtrader` has built-in support for resampling by passing the original data
    through a filter object. Although there are several ways to achieve this, a straightforward
    interface exists to achieve this:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡å°†åŸå§‹æ•°æ®é€šè¿‡è¿‡æ»¤å™¨å¯¹è±¡ä¼ é€’ç»™backtraderæ¥æ”¯æŒé‡æ–°é‡‡æ ·ã€‚è™½ç„¶æœ‰å‡ ç§å®ç°æ–¹æ³•ï¼Œä½†å­˜åœ¨ä¸€ç§ç®€å•çš„æ¥å£æ¥å®ç°ï¼š
- en: Instead of using `cerebro.adddata(data)` to put a `data` into the system use
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨`cerebro.adddata(data)`å°†`data`æ”¾å…¥ç³»ç»Ÿä¸­ï¼Œè€Œä¸æ˜¯
- en: '`cerebro.resampledata(data, **kwargs)`'
  id: totrans-6
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`cerebro.resampledata(data, **kwargs)`'
- en: There are two main options that can be controlled
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰ä¸¤ä¸ªä¸»è¦é€‰é¡¹å¯ä»¥æ§åˆ¶
- en: Change the timeframe
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è°ƒæ•´æ—¶é—´èŒƒå›´
- en: Compress bars
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‹ç¼©æ¡
- en: 'To do so, use the following parameters when calling `resampledata`:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: è¦è¿™æ ·åšï¼Œè¯·åœ¨è°ƒç”¨`resampledata`æ—¶ä½¿ç”¨ä»¥ä¸‹å‚æ•°ï¼š
- en: '`timeframe` (default: bt.TimeFrame.Days)'
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`timeframe`ï¼ˆé»˜è®¤ï¼šbt.TimeFrame.Daysï¼‰'
- en: Destination timeframe which to be useful has to be equal or larger than the
    source
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ç›®æ ‡æ—¶é—´èŒƒå›´ï¼Œå¿…é¡»ç­‰äºæˆ–å¤§äºæºæ—¶é—´
- en: '`compression` (default: 1)'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`compression`ï¼ˆé»˜è®¤ï¼š1ï¼‰'
- en: Compress the selected value â€œnâ€ to 1 bar
  id: totrans-14
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å°†é€‰å®šå€¼â€œnâ€å‹ç¼©ä¸º1æ¡
- en: 'Letâ€™s see an example from Daily to Weekly with a handcrafted script:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä»æ¯æ—¥åˆ°æ¯å‘¨çš„æ‰‹å·¥è„šæœ¬ç¤ºä¾‹ï¼š
- en: '[PRE0]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The output:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![image](../Images/d663e94f4280a6be53ffbd6fd3f6b80e.png)'
  id: totrans-18
  prefs: []
  type: TYPE_IMG
  zh: '![image](../Images/d663e94f4280a6be53ffbd6fd3f6b80e.png)'
- en: 'We can compare it to the original daily data:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥å°†å…¶ä¸åŸå§‹çš„æ¯æ—¥æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼š
- en: '[PRE1]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The output:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![image](../Images/3e14efdeed5c582c7e64ff122859ffd3.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![image](../Images/3e14efdeed5c582c7e64ff122859ffd3.png)'
- en: 'The magic is done by executing the following steps:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡æ‰§è¡Œä»¥ä¸‹æ­¥éª¤å®Œæˆé­”æœ¯ï¼š
- en: Loading the data as usual
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åƒå¾€å¸¸ä¸€æ ·åŠ è½½æ•°æ®
- en: 'Feeding the data into cerebro with `resampledata` with the desired parameters:'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†æ•°æ®ä½¿ç”¨`resampledata`ä¸æ‰€éœ€å‚æ•°è¾“å…¥åˆ°cerebroä¸­ï¼š
- en: '`timeframe`'
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`timeframe`'
- en: '`compression`'
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`compression`'
- en: The code in the sample (the entire script at the bottom).
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: æ ·æœ¬ä¸­çš„ä»£ç ï¼ˆæ•´ä¸ªè„šæœ¬åœ¨åº•éƒ¨ï¼‰ã€‚
- en: '[PRE2]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'A last example in which we first change the time frame from daily to weekly
    and then apply a 3 to 1 compression:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€åä¸€ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ—¶é—´æ¡†æ¶ä»æ¯æ—¥æ›´æ”¹ä¸ºæ¯å‘¨ï¼Œç„¶ååº”ç”¨3æ¯”1çš„å‹ç¼©ï¼š
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'The output:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: è¾“å‡ºï¼š
- en: '![image](../Images/e627e859fd4df09ec16f16603bc912a4.png)'
  id: totrans-33
  prefs: []
  type: TYPE_IMG
  zh: '![image](../Images/e627e859fd4df09ec16f16603bc912a4.png)'
- en: 'From the original 256 daily bars we end up with 18 3-week bars. The breakdown:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: ä»åŸå§‹çš„256ä¸ªæ¯æ—¥æ¡åˆ°18ä¸ª3å‘¨æ¡ã€‚æ‹†åˆ†ï¼š
- en: 52 weeks
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 52å‘¨
- en: 52 / 3 = 17.33 and therefore 18 bars
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 52 / 3 = 17.33ï¼Œå› æ­¤18ä¸ªæ¡
- en: It doesnâ€™t take much more. Of course intraday data can also be resampled.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ä¹Ÿä¸éœ€è¦æ›´å¤šã€‚å½“ç„¶ï¼Œåˆ†æ—¶æ•°æ®ä¹Ÿå¯ä»¥é‡æ–°é‡‡æ ·ã€‚
- en: 'The resampling filter supports additional parameters, which in most cases should
    not be touched:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: é‡æ–°é‡‡æ ·è¿‡æ»¤å™¨æ”¯æŒé™„åŠ å‚æ•°ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸åº”è¯¥è§¦åŠï¼š
- en: '`bar2edge` (default: `True`)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`bar2edge`ï¼ˆé»˜è®¤ï¼š`True`ï¼‰'
- en: resamples using time boundaries as the target. For example with a â€œticks ->
    5 secondsâ€ the resulting 5 seconds bars will be aligned to xx:00, xx:05, xx:10
    â€¦
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ—¶é—´è¾¹ç•Œä½œä¸ºç›®æ ‡çš„é‡æ–°é‡‡æ ·ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨â€œticks -> 5ç§’â€ï¼Œç»“æœä¸º5ç§’çš„æ¡å°†ä¸xx:00ã€xx:05ã€xx:10å¯¹é½...
- en: '`adjbartime` (default: `True`)'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`adjbartime`ï¼ˆé»˜è®¤ï¼š`True`ï¼‰'
- en: Use the time at the boundary to adjust the time of the delivered resampled bar
    instead of the last seen timestamp. If resampling to â€œ5 secondsâ€ the time of the
    bar will be adjusted for example to hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")05 even if the last seen timestamp was hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")04.33
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¾¹ç•Œæ—¶é—´æ¥è°ƒæ•´ä¼ é€’çš„é‡æ–°é‡‡æ ·æ¡çš„æ—¶é—´ï¼Œè€Œä¸æ˜¯æœ€åä¸€æ¬¡çœ‹åˆ°çš„æ—¶é—´æˆ³ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé‡æ–°é‡‡æ ·åˆ°â€œ5ç§’â€ï¼Œåˆ™æ¡çš„æ—¶é—´å°†è¢«è°ƒæ•´ä¸ºhh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")05ï¼Œå³ä½¿æœ€åä¸€æ¬¡çœ‹åˆ°çš„æ—¶é—´æˆ³æ˜¯hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")04.33ã€‚
- en: Note
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: æ³¨æ„
- en: Time will only be adjusted if â€œbar2edgeâ€ is True. It wouldnâ€™t make sense to
    adjust the time if the bar has not been aligned to a boundary
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å¦‚æœâ€œbar2edgeâ€ä¸ºTrueï¼Œåªä¼šè°ƒæ•´æ—¶é—´ã€‚å¦‚æœæ¡æœªå¯¹é½åˆ°è¾¹ç•Œï¼Œè°ƒæ•´æ—¶é—´æ˜¯æ²¡æœ‰æ„ä¹‰çš„
- en: '`rightedge` (default: `True`)'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`rightedge`ï¼ˆé»˜è®¤ï¼š`True`ï¼‰'
- en: Use the right edge of the time boundaries to set the time.
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ä½¿ç”¨æ—¶é—´è¾¹ç•Œçš„å³è¾¹æ¥è®¾ç½®æ—¶é—´ã€‚
- en: If False and compressing to 5 seconds the time of a resampled bar for seconds
    between hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png ":mm:")00 and hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")04 will be hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png ":mm:")00
    (the starting boundary
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å¦‚æœä¸º False å¹¶ä¸”å°†é‡é‡‡æ ·çš„é—´éš”å‹ç¼©åˆ° 5 ç§’ï¼Œåˆ™åœ¨ hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")00 å’Œ hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png ":mm:")04 ä¹‹é—´çš„ç§’é’Ÿçš„æƒ…å†µä¸‹ï¼Œé‡é‡‡æ ·æ¡çš„æ—¶é—´å°†ä¸º
    hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png ":mm:")00ï¼ˆèµ·å§‹è¾¹ç•Œ
- en: If True the used boundary for the time will be hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png
    ":mm:")05 (the ending boundary)
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å¦‚æœä¸º Trueï¼Œåˆ™æ—¶é—´çš„ä½¿ç”¨è¾¹ç•Œå°†ä¸º hh![ğŸ‡²ğŸ‡²](../Images/3e6ba424774c41defcb4e0fc29c71826.png ":mm:")05ï¼ˆç»“æŸè¾¹ç•Œï¼‰
- en: '`boundoff` (default: `0`)'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`boundoff`ï¼ˆé»˜è®¤å€¼ï¼š`0`ï¼‰'
- en: Push the boundary for resampling/replaying by an amount of units.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å°†é‡é‡‡æ ·/é‡æ’­çš„è¾¹ç•Œæ¨è¿›å•ä½æ•°é‡ã€‚
- en: If for example the resampling is from *1 minute* to *15 minutes*, the default
    behavior is to take the 1-minute bars from *00:01:00* until *00:15:00* to produce
    a 15-minutes replayed/resampled bar.
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œå¦‚æœé‡é‡‡æ ·çš„æ—¶é—´ä» *1 åˆ†é’Ÿ* åˆ° *15 åˆ†é’Ÿ*ï¼Œåˆ™é»˜è®¤è¡Œä¸ºæ˜¯ä» *00:01:00* åˆ° *00:15:00* å– 1 åˆ†é’Ÿçš„æ¡æ¥ç”Ÿæˆä¸€ä¸ª
    15 åˆ†é’Ÿçš„é‡æ’­/é‡é‡‡æ ·æ¡ã€‚
- en: 'If `boundoff` is set to `1`, then the boundary is pushed `1 unit` forward.
    In this case the original *unit* is a *1-minute* bar. Consequently the resampling/replaying
    will now:'
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: å¦‚æœ `boundoff` è®¾ç½®ä¸º `1`ï¼Œåˆ™è¾¹ç•Œå‘å‰æ¨è¿› `1 ä¸ªå•ä½`ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸå§‹çš„ *å•ä½* æ˜¯ä¸€ä¸ª *1 åˆ†é’Ÿ* çš„æ¡ã€‚ å› æ­¤ï¼Œç°åœ¨é‡é‡‡æ ·/é‡æ’­å°†ä¼šï¼š
- en: Use the bars from *00:00:00* to *00:14:00* for the generation of the 15-minutes
    bar
  id: totrans-53
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨ä» *00:00:00* åˆ° *00:14:00* çš„æ¡æ¥ç”Ÿæˆ 15 åˆ†é’Ÿçš„æ¡
- en: The sample code for the resampling test script.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: é‡é‡‡æ ·æµ‹è¯•è„šæœ¬çš„ç¤ºä¾‹ä»£ç ã€‚
- en: '[PRE4]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
