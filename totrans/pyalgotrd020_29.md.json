["```py\nfrom __future__ import print_function\n\nfrom pyalgotrade import strategy\nfrom pyalgotrade import plotter\nfrom pyalgotrade.tools import quandl\nfrom pyalgotrade.technical import vwap\nfrom pyalgotrade.stratanalyzer import sharpe\n\nclass VWAPMomentum(strategy.BacktestingStrategy):\n    def __init__(self, feed, instrument, vwapWindowSize, threshold):\n        super(VWAPMomentum, self).__init__(feed)\n        self.__instrument = instrument\n        self.__vwap = vwap.VWAP(feed[instrument], vwapWindowSize)\n        self.__threshold = threshold\n\n    def getVWAP(self):\n        return self.__vwap\n\n    def onBars(self, bars):\n        vwap = self.__vwap[-1]\n        if vwap is None:\n            return\n\n        shares = self.getBroker().getShares(self.__instrument)\n        price = bars[self.__instrument].getClose()\n        notional = shares * price\n\n        if price > vwap * (1 + self.__threshold) and notional < 1000000:\n            self.marketOrder(self.__instrument, 100)\n        elif price < vwap * (1 - self.__threshold) and notional > 0:\n            self.marketOrder(self.__instrument, -100)\n\ndef main(plot):\n    instrument = \"AAPL\"\n    vwapWindowSize = 5\n    threshold = 0.01\n\n    # Download the bars.\n    feed = quandl.build_feed(\"WIKI\", [instrument], 2011, 2012, \".\")\n\n    strat = VWAPMomentum(feed, instrument, vwapWindowSize, threshold)\n    sharpeRatioAnalyzer = sharpe.SharpeRatio()\n    strat.attachAnalyzer(sharpeRatioAnalyzer)\n\n    if plot:\n        plt = plotter.StrategyPlotter(strat, True, False, True)\n        plt.getInstrumentSubplot(instrument).addDataSeries(\"vwap\", strat.getVWAP())\n\n    strat.run()\n    print(\"Sharpe ratio: %.2f\" % sharpeRatioAnalyzer.getSharpeRatio(0.05))\n\n    if plot:\n        plt.plot()\n\nif __name__ == \"__main__\":\n    main(True) \n```", "```py\n2017-07-24 22:43:34,182 quandl [INFO] Downloading AAPL 2011 to ./WIKI-AAPL-2011-quandl.csv\n2017-07-24 22:43:36,415 quandl [INFO] Downloading AAPL 2012 to ./WIKI-AAPL-2012-quandl.csv\nSharpe ratio: 0.89\n\n```"]